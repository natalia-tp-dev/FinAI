<section class="container-main">
    <div class="header-container">
        <header>
            <i class="bi bi-robot" style="font-size: 30px; color: #e92545;"></i>
            <h2>AI Goal's Assistant</h2>
        </header>
    </div>

    <div class="container-content">
        <div class="goals-container">
            <h3>ANALYZED GOALS</h3>
            <div class="container-goals">
                @if (goalList().length === 0) {
                <div class="empty-list-ai">
                    <p>No goals found to analyze.</p>
                </div>
                } @else {
                @for(goal of goalList(); track goal.id) {
                <div class="goal-item"
                    [class.active]="selectedReport()?.ai_advice?.roadmap?.[0]?.title?.includes(goal.name) || false"
                    (click)="loadReport(goal.id!)">
                    <div class="info">
                        <h6>{{ goal.name }}</h6>
                        <p>Feasibility: <span [ngClass]="goal.feasibility?.toLowerCase()">
                                {{ goal.feasibility }}
                            </span></p>
                    </div>
                </div>
                }
                <button class="btn-dashed">
                    <i class="bi bi-plus"></i> New Goal
                </button>
                }
            </div>
        </div>
        <div class="analysis-panel">
            @if (selectedReport(); as report) {
            <div class="roadmap-card">
                <div class="roadmap-left">
                    <div class="roadmap-title">
                        <i class="bi bi-signpost-split-fill"></i> ROAD ANALYZE
                    </div>
                    <h5>{{ report.status_message }}</h5>
                    <p>Projected for date: {{ report.predicted_completion_date }}</p>

                    <div class="stats-row">
                        <div class="stat-box">
                            <small>WEEKLY SAVING</small>
                            <strong>{{ report.ai_advice.savings_plan.weekly | currency }}</strong>
                        </div>
                        <div class="stat-box">
                            <small>MONTHLY SAVING</small>
                            <strong>{{ report.ai_advice.savings_plan.monthly | currency }}</strong>
                        </div>
                    </div>

                    <ul class="steps-list">
                        @for(step of report.ai_advice.roadmap; track step.step_number){
                        <li><strong>{{ step.title }}</strong> {{ step.description }}</li>
                        }
                    </ul>
                </div>

                <div class="analysis-widgets">
                    <div class="widget">
                        <h6><i class="bi bi-piggy-bank-fill" style="color: #D69E2E;"></i> Optimization</h6>
                        @for(cut of report.ai_advice.budget_cuts; track cut.category) {
                        <div class="opt-row">
                            <span>{{ cut.category }}</span>
                            <span class="neg">- {{ cut.total_cut | currency }}</span>
                        </div>
                        }
                    </div>

                    <div class="widget ai-box">
                        <i class="bi bi-magic"></i>
                        <p>{{ report.ai_advice.motivation }}</p>
                    </div>
                </div>
            </div>
            } @else {
            <div class="empty-analysis">
                <div class="ai-sparkle">
                    <i class="bi bi-robot"></i>
                </div>
                <h4>Ready to Analyze?</h4>
                <p>Select a goal from the list to see your personalized AI roadmap and saving strategy.</p>
                <div class="hint">
                    <i class="bi bi-lightbulb"></i>
                    <span>The IA will calculate the best budget cuts for you.</span>
                </div>
            </div>
            }
        </div>
    </div>
</section>